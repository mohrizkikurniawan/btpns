***********************************
SUBROUTINE ID.NDC.AA.AC.V.ANTHR.BNK.INFO
***********************************
* Company   Name     : BTPNS
* Developed By       : HASSAN ZAHOOR
***********************************
* Description        : This routine will check the field MUD.CLEARED, if �Y� is selected then error on required fields.
* Subroutine Type 	 : SUBROUTINE
* Attached to        : ACTIVITY.API>ID.NDC.IS.DEP.API
* Attached as 		 : PRE ROUTINE
* In Parameter       : NONE
* IN.PARAM.NAME      : NONE
* IN.PARAM.ID 		 : NONE
* Out Parameter 	 : NONE
* OUT.PARAM 		 : NONE
* FSD			 :Funding
***********************************
* ---------------------------------
* MODIFICATION DETAILS:
* ---------------------------------
***********************************

$INSERT I_EQUATE
$INSERT I_COMMON
$INSERT I_AA.LOCAL.COMMON
$INSERT I_F.AA.SETTLEMENT

GOSUB INIT
GOSUB PROCESS
RETURN

INIT:
	
	Y.APL		= "AA.ARR.SETTLEMENT"
	Y.FLD		= "MUD.CLEARED":VM:"BEN.ACC":VM:"ATI.BEN.NAME":VM:"SKN.RTGS":VM:"RTGS.BANK.G2":VM:"TXN.CODE.G2":VM:"TO.ACC.BRANCH":VM:"BEN.ADDR":VM:"BEN.NATIONALITY":VM:"BEN.CITY.CODE":VM:"BEN.CITY.NAME":VM:"SKN.RCV.TXN":VM:"SKN.TXN.CODE":VM:"SKN.RCV.TYPE":VM:"SKN.RCV.RESIDE":VM:"NATION.STATUS":VM:"SKN.RECEIV.BANK":VM:"SKN.RCV.ID":VM:"SKN.RCV.STREET":VM:"TO.CITY.CODE":VM:"TO.CITY.NAME":VM:"L.WAIVE.CHG"
	Y.POS		= ""
	CALL MULTI.GET.LOC.REF(Y.APL,Y.FLD,Y.POS)
	Y.MUD.CLEARED 		= Y.POS<1,1>
	Y.BEN.ACC			= Y.POS<1,2>
	Y.BEN.NAME			= Y.POS<1,3>
	Y.SKN.RTGS			= Y.POS<1,4>
	Y.RTGS.BANK.G2		= Y.POS<1,5>	;*RTGS
	Y.TXN.CODE.G2		= Y.POS<1,6>    ;*RTGS
	Y.TO.ACC.BRANCH		= Y.POS<1,7>    ;*RTGS
	Y.BEN.ADDR			= Y.POS<1,8>    ;*RTGS
	Y.BEN.NATIONALITY	= Y.POS<1,9>    ;*RTGS
	
	*** MODIFICATION BY NOUSHAD STARTS ;****
	
	Y.BEN.CITY.CODE		= Y.POS<1,10>   ;*RTGS
	Y.BEN.CITY.NAME		= Y.POS<1,11>   ;*RTGS
	Y.TO.CITY.CODE		= Y.POS<1,20>   ;*RTGS
	Y.TO.CITY.NAME		= Y.POS<1,21>   ;*RTGS
	
	*** MODIFICATION BY NOUSHAD ENDS ;****
	
	Y.SKN.RCV.TXN		= Y.POS<1,12>	;*SKN
	Y.SKN.TXN.CODE		= Y.POS<1,13>   ;*SKN
	Y.SKN.RCV.TYPE		= Y.POS<1,14>   ;*SKN
	Y.SKN.RCV.RESIDE	= Y.POS<1,15>   ;*SKN
	Y.NATION.STATUS		= Y.POS<1,16>   ;*SKN
	Y.SKN.RECEIV.BANK	= Y.POS<1,17>   ;*SKN
	Y.SKN.RCV.ID		= Y.POS<1,18>   ;*SKN
	Y.SKN.RCV.STREET	= Y.POS<1,19>   ;*SKN
	
*modified by MRK - 20230126 - BifastDepoMaterai
	vWaiveChgPos		= Y.POS<1,22>
	

RETURN	

PROCESS:

	Y.AA.ID		= c_aalocArrangementRec

	Y.MC			 	= R.NEW(AA.SET.LOCAL.REF)<1,Y.MUD.CLEARED> ;*Y_N
	Y.BAC			 	= R.NEW(AA.SET.LOCAL.REF)<1,Y.BEN.ACC> ;*Mandatory if MudCleared is Y
	Y.BN			 	= R.NEW(AA.SET.LOCAL.REF)<1,Y.BEN.NAME> ;*Mandatory if MudCleared is Y
	Y.L.SKN.RTGS	 	= R.NEW(AA.SET.LOCAL.REF)<1,Y.SKN.RTGS> ;*SKN(1) atau RTGS(2)
	Y.L.SKN.RCV.TXN  	= R.NEW(AA.SET.LOCAL.REF)<1,Y.SKN.RCV.TXN> ;*Transaction Facility Type
	Y.L.SKN.RCV.TYPE 	= R.NEW(AA.SET.LOCAL.REF)<1,Y.SKN.RCV.TYPE> ;*Reciever Customer Type
	Y.L.SKN.RCV.RESIDE	= R.NEW(AA.SET.LOCAL.REF)<1,Y.SKN.RCV.RESIDE> ;*Citizenship Status
	Y.L.NATION.STATUS	= R.NEW(AA.SET.LOCAL.REF)<1,Y.NATION.STATUS> ;*Nationality Status
	Y.L.SKN.RECEIV.BANK	= R.NEW(AA.SET.LOCAL.REF)<1,Y.SKN.RECEIV.BANK> ;*Reciever Bank Code
	Y.L.SKN.RCV.ID		= R.NEW(AA.SET.LOCAL.REF)<1,Y.SKN.RCV.ID> ;*Reciever Customer Identity
	Y.L.SKN.RCV.STREET	= R.NEW(AA.SET.LOCAL.REF)<1,Y.SKN.RCV.STREET> ;*Reciever Customer Address
	Y.L.RTGS.BANK.G2	= R.NEW(AA.SET.LOCAL.REF)<1,Y.RTGS.BANK.G2> ;*Member Destination
	Y.L.TXN.CODE.G2		= R.NEW(AA.SET.LOCAL.REF)<1,Y.TXN.CODE.G2> ;*Transaction Information
	Y.L.TO.ACC.BRANCH	= R.NEW(AA.SET.LOCAL.REF)<1,Y.TO.ACC.BRANCH> ;*Branch
	Y.L.BEN.ADDR		= R.NEW(AA.SET.LOCAL.REF)<1,Y.BEN.ADDR> ;*Reciever Customer Address
	Y.L.BEN.NATIONALITY	= R.NEW(AA.SET.LOCAL.REF)<1,Y.BEN.NATIONALITY> ;*Nationality Status

*modified by MRK - 20230126 - BifastDepoMaterai
	vWaiveChg			= R.NEW(AA.SET.LOCAL.REF)<1, vWaiveChgPos>
	IF vWaiveChg EQ '' THEN
		R.NEW(AA.SET.LOCAL.REF)<1, vWaiveChgPos>	= 'NO'
	END
	
	
* Changes Budis - Default Kode 50 jika transfer ke SKN
        Y.SKN.CODE = R.NEW(AA.SET.LOCAL.REF)<1,Y.SKN.TXN.CODE>

        IF Y.MC EQ 'Y' AND Y.L.SKN.RTGS EQ '1' AND Y.SKN.CODE EQ '' THEN
	   R.NEW(AA.SET.LOCAL.REF)<1,Y.SKN.TXN.CODE> = '50'
	END
	Y.L.SKN.TXN.CODE 	= R.NEW(AA.SET.LOCAL.REF)<1,Y.SKN.TXN.CODE> ;*Transaction Code
	
	*** MODIFICATION BY NOUSHAD STARTS ;****
	
	Y.L.BEN.CITY.CODE	= R.NEW(AA.SET.LOCAL.REF)<1,Y.BEN.CITY.CODE> ;*Ben City Code
	Y.L.BEN.CITY.NAME	= R.NEW(AA.SET.LOCAL.REF)<1,Y.BEN.CITY.NAME> ;*Ben City Name
	Y.L.TO.CITY.CODE	= R.NEW(AA.SET.LOCAL.REF)<1,Y.TO.CITY.CODE> ;*To City Code
	Y.L.TO.CITY.NAME	= R.NEW(AA.SET.LOCAL.REF)<1,Y.TO.CITY.NAME> ;*To City Name
	
	*** MODIFICATION BY NOUSHAD ENDS ;****
		
	BEGIN CASE
	
	CASE Y.MC EQ 'N' OR Y.MC EQ ''
	
	*** MODIFICATION BY NOUSHAD STARTS ;****
	
		R.NEW(AA.SET.LOCAL.REF)<1,Y.BEN.ACC> 		= ''
		R.NEW(AA.SET.LOCAL.REF)<1,Y.BEN.NAME> 		= ''
		R.NEW(AA.SET.LOCAL.REF)<1,Y.SKN.RTGS> 		= ''
		
		R.NEW(AA.SET.LOCAL.REF)<1,Y.RTGS.BANK.G2> 		= ''
		R.NEW(AA.SET.LOCAL.REF)<1,Y.TXN.CODE.G2> 		= ''
		R.NEW(AA.SET.LOCAL.REF)<1,Y.TO.ACC.BRANCH> 		= ''
		R.NEW(AA.SET.LOCAL.REF)<1,Y.BEN.ADDR> 			= ''
		R.NEW(AA.SET.LOCAL.REF)<1,Y.BEN.NATIONALITY> 	= ''
		R.NEW(AA.SET.LOCAL.REF)<1,Y.BEN.CITY.CODE> 		= ''
		R.NEW(AA.SET.LOCAL.REF)<1,Y.BEN.CITY.NAME> 		= ''
		R.NEW(AA.SET.LOCAL.REF)<1,Y.TO.CITY.CODE> 		= ''
		R.NEW(AA.SET.LOCAL.REF)<1,Y.TO.CITY.NAME> 		= ''
		
		R.NEW(AA.SET.LOCAL.REF)<1,Y.SKN.RCV.TXN> 		= ''
		R.NEW(AA.SET.LOCAL.REF)<1,Y.SKN.TXN.CODE> 		= ''
		R.NEW(AA.SET.LOCAL.REF)<1,Y.SKN.RCV.TYPE> 		= ''
		R.NEW(AA.SET.LOCAL.REF)<1,Y.SKN.RCV.RESIDE> 	= ''
		R.NEW(AA.SET.LOCAL.REF)<1,Y.NATION.STATUS> 		= ''
		R.NEW(AA.SET.LOCAL.REF)<1,Y.SKN.RECEIV.BANK> 	= ''
		R.NEW(AA.SET.LOCAL.REF)<1,Y.SKN.RCV.ID> 		= ''
		R.NEW(AA.SET.LOCAL.REF)<1,Y.SKN.RCV.STREET> 	= ''
		
	*** MODIFICATION BY NOUSHAD ENDS  ;****
	
	CASE Y.MC EQ 'Y' AND (Y.BAC EQ '' AND Y.BN EQ '')
		ETEXT = "EB-ID.NDC.ACCOUNT.NAME.MISSING"
		AF = AA.SET.LOCAL.REF
		AV = Y.MUD.CLEARED
		AS = 0
		CALL STORE.END.ERROR
	
	CASE Y.MC EQ 'Y' AND Y.BAC EQ ''
		ETEXT = "EB-ID.NDC.ACCOUNT.NO.MISSING"
		AF = AA.SET.LOCAL.REF
		AV = Y.BEN.ACC
		AS = 0
		CALL STORE.END.ERROR
	
	CASE Y.MC EQ 'Y' AND Y.BN EQ ''
		ETEXT = "EB-ID.NDC.REC.NAME.MISSING"
		AF = AA.SET.LOCAL.REF
		AV = Y.BEN.NAME
		AS = 0
		CALL STORE.END.ERROR
	
	*** MODIFICATION BY NOUSHAD STARTS ;****
		
	CASE Y.MC EQ 'Y' AND Y.L.SKN.RTGS EQ ''
		ETEXT = "EB-ID.NDC.REC.SKN.RTGS.MISSING"
		AF = AA.SET.LOCAL.REF
		AV = Y.SKN.RTGS
		AS = 0
		CALL STORE.END.ERROR
		
	*** MODIFICATION BY NOUSHAD ENDS  ;****
	
	
	CASE Y.L.SKN.RTGS EQ '1'
		
		*** MODIFICATION BY NOUSHAD STARTS ;****
	
		R.NEW(AA.SET.LOCAL.REF)<1,Y.RTGS.BANK.G2> 		= ''
		R.NEW(AA.SET.LOCAL.REF)<1,Y.TXN.CODE.G2> 		= ''
		R.NEW(AA.SET.LOCAL.REF)<1,Y.TO.ACC.BRANCH> 		= ''
		R.NEW(AA.SET.LOCAL.REF)<1,Y.BEN.ADDR> 			= ''
		R.NEW(AA.SET.LOCAL.REF)<1,Y.BEN.NATIONALITY> 	= ''
		R.NEW(AA.SET.LOCAL.REF)<1,Y.BEN.CITY.CODE> 		= ''
		R.NEW(AA.SET.LOCAL.REF)<1,Y.BEN.CITY.NAME> 		= ''
		R.NEW(AA.SET.LOCAL.REF)<1,Y.TO.CITY.CODE> 		= ''
		R.NEW(AA.SET.LOCAL.REF)<1,Y.TO.CITY.NAME> 		= ''
		
		*** MODIFICATION BY NOUSHAD ENDS  ;****
	
		BEGIN CASE
			CASE Y.L.SKN.RCV.TXN EQ ''
				ETEXT = "EB-ID.NDC.TRANS.FAC.TYPE.MISSING"
				AF = AA.SET.LOCAL.REF
				AV = Y.SKN.RCV.TXN
				AS = 0
				CALL STORE.END.ERROR	
			CASE Y.L.SKN.TXN.CODE EQ ''
				ETEXT = "EB-ID.NDC.TRANS.CODE.MISSING"
				AF = AA.SET.LOCAL.REF
				AV = Y.SKN.TXN.CODE
				AS = 0
				CALL STORE.END.ERROR
			CASE Y.L.SKN.RCV.TYPE EQ ''
				ETEXT = "EB-ID.NDC.REC.CUS.TYPE.MISSING"
				AF = AA.SET.LOCAL.REF
				AV = Y.SKN.RCV.TYPE
				AS = 0
				CALL STORE.END.ERROR
			CASE Y.L.SKN.RCV.RESIDE EQ ''
				ETEXT = "EB-ID.NDC.CIT.STA.MISSING"
				AF = AA.SET.LOCAL.REF
				AV = Y.SKN.RCV.RESIDE
				AS = 0
				CALL STORE.END.ERROR
			CASE Y.L.NATION.STATUS EQ ''
				ETEXT = "EB-ID.NDC.NAT.STA.MISSING"
				AF = AA.SET.LOCAL.REF
				AV = Y.NATION.STATUS
				AS = 0
				CALL STORE.END.ERROR
			CASE Y.L.SKN.RECEIV.BANK EQ ''
				ETEXT = "EB-ID.NDC.REC.BANK.CODE.MISSING"
				AF = AA.SET.LOCAL.REF
				AV = Y.SKN.RECEIV.BANK
				AS = 0
				CALL STORE.END.ERROR
			CASE Y.L.SKN.RCV.ID EQ ''
				ETEXT = "EB-ID.NDC.REC.CUS.ID.MISSING"
				AF = AA.SET.LOCAL.REF
				AV = Y.SKN.RCV.ID
				AS = 0
				CALL STORE.END.ERROR
			CASE Y.L.SKN.RCV.STREET EQ ''
				ETEXT = "EB-ID.NDC.REC.CUS.ADDR.MISSING"
				AF = AA.SET.LOCAL.REF
				AV = Y.SKN.RCV.STREET
				AS = 0
				CALL STORE.END.ERROR				
		END CASE
	
	CASE Y.L.SKN.RTGS EQ '2'
	
		*** MODIFICATION BY NOUSHAD STARTS ;****
		
		R.NEW(AA.SET.LOCAL.REF)<1,Y.SKN.RCV.TXN> 		= ''
		R.NEW(AA.SET.LOCAL.REF)<1,Y.SKN.TXN.CODE> 		= ''
		R.NEW(AA.SET.LOCAL.REF)<1,Y.SKN.RCV.TYPE> 		= ''
		R.NEW(AA.SET.LOCAL.REF)<1,Y.SKN.RCV.RESIDE> 	= ''
		R.NEW(AA.SET.LOCAL.REF)<1,Y.NATION.STATUS> 		= ''
		R.NEW(AA.SET.LOCAL.REF)<1,Y.SKN.RECEIV.BANK> 	= ''
		R.NEW(AA.SET.LOCAL.REF)<1,Y.SKN.RCV.ID> 		= ''
		R.NEW(AA.SET.LOCAL.REF)<1,Y.SKN.RCV.STREET> 	= ''
		
		*** MODIFICATION BY NOUSHAD ENDS  ;****
		
		BEGIN CASE
			CASE Y.L.RTGS.BANK.G2 EQ ''
				ETEXT = "EB-ID.NDC.MEM.DES.MISSING"
				AF = AA.SET.LOCAL.REF
				AV = Y.RTGS.BANK.G2
				AS = 0
				CALL STORE.END.ERROR
			CASE Y.L.TXN.CODE.G2 EQ ''
				ETEXT = "EB-ID.NDC.TRANS.INF.MISSING"
				AF = AA.SET.LOCAL.REF
				AV = Y.TXN.CODE.G2
				AS = 0
				CALL STORE.END.ERROR	
			CASE Y.L.TO.ACC.BRANCH EQ ''
				ETEXT = "EB-ID.NDC.BRANCH.MISSING"
				AF = AA.SET.LOCAL.REF
				AV = Y.TO.ACC.BRANCH
				AS = 0
				CALL STORE.END.ERROR
			CASE Y.L.BEN.ADDR EQ ''
				ETEXT = "EB-ID.NDC.REC.CUS.ADDR.MISSING"
				AF = AA.SET.LOCAL.REF
				AV = Y.BEN.ADDR
				AS = 0
				CALL STORE.END.ERROR
			CASE Y.L.BEN.NATIONALITY EQ ''
				ETEXT = "EB-ID.NDC.NAT.STA.MISSING"
				AF = AA.SET.LOCAL.REF
				AV = Y.BEN.NATIONALITY
				AS = 0
				CALL STORE.END.ERROR
			
			*** MODIFICATION BY NOUSHAD STARTS ;****
			
			CASE Y.L.BEN.CITY.CODE EQ ''
				ETEXT = "EB-ID.NDC.BEN.CITY.CO.MISSING"
				AF = AA.SET.LOCAL.REF
				AV = Y.BEN.CITY.CODE
				AS = 0
				CALL STORE.END.ERROR
			CASE Y.L.BEN.CITY.NAME EQ ''
				ETEXT = "EB-ID.NDC.BEN.CITY.NAME.MISSING"
				AF = AA.SET.LOCAL.REF
				AV = Y.BEN.CITY.NAME
				AS = 0
				CALL STORE.END.ERROR
			CASE Y.L.TO.CITY.CODE EQ ''
				ETEXT = "EB-ID.NDC.TO.CITY.CO.MISSING"
				AF = AA.SET.LOCAL.REF
				AV = Y.TO.CITY.CODE
				AS = 0
				CALL STORE.END.ERROR
			CASE Y.L.TO.CITY.NAME EQ ''
				ETEXT = "EB-ID.NDC.TO.CITY.NAME.MISSING"
				AF = AA.SET.LOCAL.REF
				AV = Y.TO.CITY.NAME
				AS = 0
				CALL STORE.END.ERROR
			
			*** MODIFICATION BY NOUSHAD ENDS ;****

			
		END CASE

	END CASE
	
	RETURN

END 
 